import{r as n,j as e,x as D,y as A,l as E,c as M,q as L,z as q,b as H,s as O,H as R}from"./index-D9A7aE9K.js";import{a as V,b as U,c as $,d as z,S as P,E as K,e as Y}from"./effect-coverflow-CoSxigLC.js";import{g as Q}from"./gallery-info-C-JrU39F.js";import{u as S,m as C}from"./mutationFactory-BVCIUn7Z.js";function G({imageUrl:t,title:s,subTitle:r,showArrow:o,onClick:l,isSelected:m,isLoading:i}){const[f,u]=n.useState(!1),c=i??!f,d=!!(s||o);return e.jsxs("button",{type:"button",onClick:l,disabled:c,"aria-busy":c,"aria-live":"polite",className:`group relative aspect-[3/4] overflow-hidden rounded-[10px] transition-transform duration-200 ease-in-out ${c?"cursor-default":"cursor-pointer"} `,children:[e.jsx("img",{src:t,alt:s??"작품 이미지",loading:"lazy",decoding:"async",onLoad:()=>u(!0),onError:()=>u(!0),className:`h-full w-full object-cover transition-opacity duration-300 ${c?"opacity-0":"opacity-100"}`}),c&&e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("div",{className:"animate-pulse h-full w-full bg-gray-10"}),d&&e.jsxs("div",{className:"absolute inset-0 flex h-full flex-col justify-between p-[2rem]",children:[e.jsx("div",{className:"h-[2.4rem] w-1/2 rounded-[6px] bg-gray-20"}),e.jsxs("div",{className:"space-y-[0.8rem]",children:[e.jsx("div",{className:"h-[1.8rem] w-3/4 rounded-[6px] bg-gray-20"}),o&&e.jsx("div",{className:"h-[1.6rem] w-[6rem] rounded-[6px] bg-gray-20"})]}),e.jsx("span",{className:"sr-only",children:"콘텐츠를 불러오는 중…"})]})]}),d&&e.jsx("div",{className:`absolute inset-0 transition-colors duration-200 ease-in-out ${m?"bg-gray-900/40":"bg-black/0 group-hover:bg-gray-100/40"} ${c?"pointer-events-none opacity-0":"opacity-100"} `,children:e.jsxs("div",{className:"flex h-full flex-col justify-between p-[2rem] text-left opacity-0 transition-opacity duration-200 ease-in-out group-hover:opacity-100",children:[e.jsx("p",{className:"text-gray-0 ct1",children:s}),o&&e.jsx("p",{className:"font-bold text-gray-0 ct3",children:r})]})})]})}function _({thumbnail:t,title:s,location:r,totalCount:o,lastDate:l,isBookmarked:m,onBookmarkToggle:i,pending:f=!1,icon:u=Q,compactTitle:c=!1}){var x;const d=((x=l.match(/^\d{4}-\d{2}-\d{2}/))==null?void 0:x[0])??l;return e.jsxs("section",{className:"flex flex-col gap-[1.6rem]",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-[1.6rem]",children:[e.jsx("img",{src:t,alt:"전시 썸네일",className:"h-[7.2rem] w-[7.2rem] rounded-[8px] object-cover"}),e.jsxs("div",{className:"flex flex-col gap-[0.4rem]",children:[e.jsx("h2",{className:`font-semibold text-gray-90 ${c?"t5":"t3"}`,children:s}),e.jsx("p",{className:"text-gray-50 ct3",children:r})]})]}),e.jsx("button",{type:"button","aria-pressed":m,"aria-label":m?"북마크 해제":"북마크 추가",onClick:i,disabled:f,className:"shrink-0 rounded-[8px] p-[0.8rem] hover:bg-gray-5 focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-mint disabled:cursor-not-allowed disabled:opacity-50",children:m?e.jsx(D,{className:"h-[2.5rem] w-[2.5rem] text-brand-mint"}):e.jsx(A,{className:"h-[2.5rem] w-[2.5rem] text-gray-70 [&>path]:[stroke-width:40]"})})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute -top-[0.6rem] left-[2rem] z-[1] h-0 w-0 border-x-[0.6rem] border-b-[0.6rem] border-x-transparent border-b-white"}),e.jsxs("div",{className:"relative z-[0] w-full rounded-[8px] bg-white px-[2rem] py-[1.6rem] shadow-sm",children:[e.jsxs("p",{className:"text-gray-80 ct2",children:[e.jsx("span",{children:"총 "}),e.jsx("span",{className:"font-bold text-[#3DAF9C]",children:o}),"개의 작품을 수집하고,",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-[#769DFF]",children:d}),"에 마지막으로 감상했어요."]}),e.jsx("div",{className:"absolute right-[1.2rem] top-1/2 h-[3.6rem] w-[3.6rem] -translate-y-1/2 overflow-hidden rounded-[6px]",children:e.jsx("img",{src:u,alt:"아이콘",className:"h-full w-full object-cover"})})]})]})]})}const Z=t=>n.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},n.createElement("path",{d:"M21 10H11C6.58172 10 3 13.5817 3 18V20M21 10L15 16M21 10L15 4",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"})),W="data:image/svg+xml,%3csvg%20width='32'%20height='23'%20viewBox='0%200%2032%2023'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='22.1714'%20cy='14.1714'%20r='5.58571'%20transform='rotate(180%2022.1714%2014.1714)'%20fill='%23347EB5'%20stroke='%23347EB5'%20stroke-width='0.485714'/%3e%3ccircle%20cx='8.56987'%20cy='14.1714'%20r='5.58571'%20transform='rotate(180%208.56987%2014.1714)'%20fill='%23347EB5'%20stroke='%23347EB5'%20stroke-width='0.485714'/%3e%3cpath%20d='M26.5428%202.99999C27.3199%202.99999%2024.5999%206.88571%2023.1428%208.82856L18.2859%2010.2857C18.7717%209.31428%2025.5713%202.99999%2026.5428%202.99999Z'%20fill='%23347EB5'%20stroke='%23347EB5'%20stroke-width='0.485714'/%3e%3cpath%20d='M12.9412%202.99999C13.7183%202.99999%2010.9983%206.88571%209.5412%208.82856L4.68438%2010.2857C5.17009%209.31428%2011.9698%202.99999%2012.9412%202.99999Z'%20fill='%23347EB5'%20stroke='%23347EB5'%20stroke-width='0.485714'/%3e%3c/svg%3e",J="/assets/gallery-back-card-rRsUht0K.png";function X({month:t="5월",date:s="22일"}){return e.jsx("div",{className:"overflow-hidden rounded-lg shadow",children:e.jsxs("div",{className:"h-[7.7rem] w-[6.9rem] overflow-hidden rounded-[0.8rem] bg-white",children:[e.jsx("div",{className:"flex h-[3.2rem] items-center justify-center rounded-t-[0.8rem] bg-blue-500",children:e.jsx("p",{className:"text-[1.4rem] font-semibold leading-[1.96rem] text-white",children:t})}),e.jsx("div",{className:"flex h-[4.5rem] items-center justify-center",children:e.jsx("p",{className:"text-[1.8rem] font-semibold leading-[2.52rem] text-blue-500",children:s})})]})})}function ee({data:t}){const[s,r]=n.useState(!1);return e.jsx("div",{className:"flex w-full flex-col items-center gap-[5.6rem] px-[2.4rem]",children:e.jsx("button",{type:"button","aria-pressed":s,"aria-label":s?"카드 앞면 보기":"카드 뒷면 보기",className:"relative h-[45rem] w-full py-[2.8rem] [perspective:1000px]",onClick:()=>r(!s),children:e.jsxs("div",{className:"inline-grid h-full w-full rounded-2xl transition-transform duration-700 ease-in-out",style:{transformStyle:"preserve-3d",transform:s?"rotateY(180deg)":"rotateY(0deg)"},children:[e.jsxs("div",{className:"absolute h-full w-full rounded-2xl [backface-visibility:hidden]",style:{transform:"rotateY(0deg)"},children:[e.jsx("img",{className:"h-full w-full rounded-2xl object-cover",src:t.imageUrl,alt:t.title}),e.jsx("div",{className:"absolute left-[2.5rem] top-[2.3rem]",children:e.jsx(X,{month:t.month,date:t.date})}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full rounded-b-2xl bg-gradient-to-b from-sky-800/0 to-blue-500 px-[2.4rem] py-[2.4rem] text-gray-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-[0.2rem] text-left",children:[e.jsx("p",{className:"bd2",children:t.location}),e.jsx("p",{className:"font-bold t2",children:t.subTitle})]}),e.jsx(Z,{className:"w-[2.4rem]"})]})})]}),e.jsx("div",{className:"absolute h-full w-full rounded-2xl [backface-visibility:hidden]",style:{transform:"rotateY(180deg)",backgroundImage:`url(${J})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-center gap-[1.6rem] px-[3.5rem] text-[#347EB5]",children:[e.jsx("img",{src:W,alt:"quote",className:"w-[3.2rem]"}),e.jsx("span",{className:"leading-relaxed t3",children:"수영하는 풍경, 그곳을 보고 나는 떠나기로 결심했다."}),e.jsx("span",{className:"ct1",children:"- 요시고"})]})})]})})})}const te=["dot-1","dot-2","dot-3","dot-4","dot-5"];function se({count:t=5,activeIndex:s=0,onDotClick:r}){return e.jsx("div",{className:"pointer-events-auto flex gap-[0.6rem]",children:te.slice(0,t).map((o,l)=>e.jsx("button",{type:"button","aria-label":`작품 ${l+1} 보기`,onClick:()=>r==null?void 0:r(l),className:`relative z-10 h-[0.8rem] w-[0.8rem] rounded-full transition-colors ${l===s?"bg-blue-500":"bg-neutral-200"}`},o))})}const re="/assets/gallery-thumbnail-Cd-EcE9o.png",b={thumbnail:re,title:"요시고 사진전",location:"서울시립미술관 서소문본관",totalCount:9,lastDate:"5월 22일"},g=[{id:"art1",imageUrl:V,title:"미끄럼틀 타는 소년의 화사한 풍경.",location:"시소 그라운드 서촌",subTitle:"OF THE SEAS",showArrow:!0},{id:"art2",imageUrl:U,title:"미끄럼틀 타는 소년의 화사한 풍경.",location:"시소 그라운드 서촌",subTitle:"OF THE SEAS",showArrow:!0},{id:"art3",imageUrl:$,title:"수영하는 소년의 화사한 풍경.",location:"시소 그라운드 서촌",subTitle:"OF THE SEAS",showArrow:!0},{id:"art4",imageUrl:z,title:"수영하는 소년의 화사한 풍경.",location:"시소 그라운드 서촌",subTitle:"OF THE SEAS",showArrow:!0}];function ae(t,s){const r=E();return S({mutationFn:C.addBookmark(t),onSuccess:()=>{[["exhibitionVisitRecent"],["popularExhibitions"],["popularExhibitionsTop"],["popularExhibitionsSuggest"],["popularExhibitionDetail",t],["exhibitionVisitDetail",t]].forEach(l=>r.invalidateQueries({queryKey:l}))}})}function le(t,s){const r=E();return S({mutationFn:C.removeBookmark(t),onSuccess:()=>{[["exhibitionVisitRecent"],["popularExhibitions"],["popularExhibitionsTop"],["popularExhibitionsSuggest"],["popularExhibitionDetail",t],["exhibitionVisitDetail",t]].forEach(l=>r.invalidateQueries({queryKey:l}))}})}function oe(t,s=!0){return M({queryKey:["exhibitionVisitDetail",t],queryFn:L.exhibitionVisitDetail(t),enabled:s&&Number.isFinite(t),staleTime:0,retry:!1})}const ie=t=>t&&typeof t=="object"?t:void 0,j=(t,s)=>s.map(r=>t==null?void 0:t[r]).find(r=>typeof r=="string"),ne=(t,s)=>s.map(r=>t==null?void 0:t[r]).find(r=>typeof r=="number"),ce=(t,s)=>s.map(r=>t==null?void 0:t[r]).find(r=>typeof r=="boolean"),de=t=>{if(!t)return 0;try{const{Segmenter:s}=Intl;if(typeof s=="function"){const r=new s("ko",{granularity:"grapheme"});return Array.from(r.segment(t)).length}}catch{}return Array.from(t).length},me=42;function pe(){const{id:t}=q(),s=Number(t),{showToast:r}=H(),{data:o,isFetching:l,isError:m}=oe(s,Number.isFinite(s)),i=n.useMemo(()=>ie(o),[o]),f=n.useRef(null),[u,c]=n.useState(null),[d,x]=n.useState(!1);n.useEffect(()=>{const a=ce(i,["bookmark","bookmarked","isBookmarked"]);typeof a=="boolean"&&x(a)},[i]);const y=ae(s),v=le(s),w=y.isPending||v.isPending,N=n.useCallback(()=>{!Number.isFinite(s)||w||(d?(x(!1),v.mutate(void 0,{onSuccess:()=>r("즐겨찾기를 해제했어요.","success"),onError:()=>{x(!0),r("즐겨찾기 해제에 실패했어요.","error")}})):(x(!0),y.mutate(void 0,{onSuccess:()=>r("즐겨찾기에 추가했어요.","success"),onError:()=>{x(!1),r("즐겨찾기 추가에 실패했어요.","error")}})))},[s,w,d,y,v,r]),h=n.useMemo(()=>{if(i){const a=O(j(i,["exhibitionImage","thumbnail","coverImage","image"])??""),p=j(i,["exhibitionTitle","title"])??"",T=j(i,["gallery","location","museum"])??"",F=ne(i,["artCount","totalCount","paintingCount","worksCount"])??g.length,I=j(i,["lastDate","visitedAt","startAt","createdAt","updatedAt","date"])??"";return{thumbnail:a,title:p,location:T,totalCount:F,lastDate:I}}return{thumbnail:b.thumbnail,title:b.title,location:b.location,totalCount:b.totalCount,lastDate:b.lastDate}},[i]),k=n.useMemo(()=>de(h.title)>me,[h.title]),B=n.useMemo(()=>l?e.jsx("div",{className:"animate-pulse h-[9.6rem] w-full rounded-[12px] bg-gray-10"}):m&&!o?e.jsx("div",{className:"rounded-[12px] bg-red-50 p-[1.2rem] text-red-500 ct4",children:"전시 정보를 불러오지 못했어요. 잠시 후 다시 시도해 주세요."}):e.jsx(_,{thumbnail:h.thumbnail,title:h.title,location:h.location,totalCount:h.totalCount,lastDate:h.lastDate,isBookmarked:d,onBookmarkToggle:N,compactTitle:k}),[l,m,o,h,k,d,N]);return e.jsxs("div",{className:"pb-[4rem]",children:[e.jsx(R,{title:"나의 전시",showBackButton:!0,backgroundColorClass:"bg-gray-5"}),e.jsx("div",{className:"flex flex-col gap-[4rem]",children:u===null?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-[2.4rem]",children:B}),e.jsx("div",{className:"grid grid-cols-2 gap-[1.2rem] px-[2.4rem]",children:g.map((a,p)=>e.jsx(G,{imageUrl:a.imageUrl,title:a.title,subTitle:a.subTitle,showArrow:a.showArrow,onClick:()=>c(p),isSelected:!1},a.id))})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full px-[2.4rem] pt-[4rem]",children:e.jsx(P,{effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",onSlideChange:a=>c(a.realIndex),initialSlide:u??0,onSwiper:a=>{f.current=a},coverflowEffect:{rotate:45,stretch:0,depth:150,modifier:1,slideShadows:!1},modules:[K],children:g.map(a=>e.jsx(Y,{className:"flex w-[36rem] justify-center",children:e.jsx(ee,{data:a})},a.id))})}),e.jsx("div",{className:"z-10 mt-[-2rem] flex justify-center",children:e.jsx(se,{count:g.length,activeIndex:u??0,onDotClick:a=>{var p;c(a),(p=f.current)==null||p.slideTo(a)}})})]})})]})}export{de as countGraphemes,pe as default};
