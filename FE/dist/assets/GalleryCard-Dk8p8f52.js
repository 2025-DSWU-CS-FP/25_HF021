import{R as m,b as I,j as e,n as T}from"./index-D9A7aE9K.js";import{L as F,t as C,a as U}from"./logo-3n7myPKj.js";const y="/assets/qr-BjPijXxY.png";function P(){const o=m.useRef(null),[h,x]=m.useState(!1),{showToast:b}=I(),a=s=>({"--i":s});function v(){return m.useMemo(()=>{const s=new Date,n=new Intl.DateTimeFormat("en-CA",{timeZone:"Asia/Seoul",year:"numeric",month:"2-digit",day:"2-digit"}).format(s),t=new Intl.DateTimeFormat("ko-KR",{timeZone:"Asia/Seoul",year:"numeric",month:"2-digit",day:"2-digit"}).format(s).replace(/\s/g,"").replace(/\.$/,"");return{dateISO:n,display:t}},[])}const f=async()=>{var n;const s=document;try{await((n=s.fonts)==null?void 0:n.ready)}catch{}},g=async s=>{const n=Array.from(s.querySelectorAll("img"));n.length!==0&&await Promise.all(n.map(t=>{if(t.complete&&t.naturalWidth>0)return Promise.resolve();const i=t.decode;return typeof i=="function"?i.call(t).catch(()=>{}):new Promise(c=>{t.addEventListener("load",()=>c(),{once:!0}),t.addEventListener("error",()=>c(),{once:!0})})}))},N=s=>{s.querySelectorAll("img").forEach(n=>{const t=n;t.crossOrigin="anonymous",t.loading="eager",t.decoding="sync",t.style.transform="translateZ(0)",t.style.objectFit||(t.style.objectFit="cover")})},u=()=>new Promise(s=>{requestAnimationFrame(()=>s())}),w=async()=>{await u(),await u()},R=()=>/iP(hone|ad|od)/.test(navigator.userAgent)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,k=async()=>{const s=o.current;if(!s)throw new Error("no target");T.flushSync(()=>x(!0)),await f(),N(s),await g(s),await w();const n=s.getBoundingClientRect(),t=Math.round(n.width),i=Math.round(n.height),c=Math.min(2,window.devicePixelRatio||1),E={transform:"none",transformOrigin:"top left",margin:"0",padding:"0",borderRadius:getComputedStyle(s).borderRadius,overflow:"hidden",webkitTextSizeAdjust:"100%"},j={backgroundColor:"#0f1114",width:t,height:i,pixelRatio:c,style:E,cacheBust:!0,filter:l=>{var d,p;return!((d=l.classList)!=null&&d.contains("noise")||(p=l.classList)!=null&&p.contains("capture-ignore"))}};let r=null;try{r=await C(s,j)}catch{}if(!r){const l=await U(s,j);r=await(await fetch(l)).blob()}return r},A=()=>/KAKAOTALK|FBAN|FBAV|Instagram|NAVER|Daum|Line/i.test(navigator.userAgent),L=async()=>{if(!(!o.current||h))try{const s=await k(),n="eyedia-ticket.png";if(R()||A()){const c=URL.createObjectURL(s);window.open(c,"_blank"),setTimeout(()=>URL.revokeObjectURL(c),1e4);return}const t=URL.createObjectURL(s),i=document.createElement("a");i.href=t,i.download=n,document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(t)}catch{b("이미지 저장에 실패했습니다.","error")}finally{x(!1)}},{dateISO:O,display:S}=v();return e.jsxs("div",{className:`relative h-dvh w-full overflow-hidden ${h?"capture-still":""}`,children:[e.jsxs("div",{className:"output fixed",children:[e.jsx("div",{className:"wrap-colors-1",children:e.jsx("div",{className:"bg-colors"})}),e.jsx("div",{className:"wrap-colors-2",children:e.jsx("div",{className:"bg-colors"})}),e.jsx("div",{className:"cover"})]}),e.jsx("div",{className:"absolute bottom-[calc(env(safe-area-inset-bottom)_+_2rem)] left-1/2 z-30 -translate-x-1/2 print:hidden",children:e.jsx("button",{type:"button",onClick:L,className:"rounded-[10px] bg-brand-mint px-[1.2rem] py-[0.6rem] text-gray-0 shadow-card bt3 hover:opacity-90 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-mint","aria-label":"티켓 이미지 저장",children:"티켓 이미지 저장"})}),e.jsx("div",{className:"area",children:e.jsx("div",{className:"area-wrapper",children:e.jsx("div",{className:"ticket-mask",children:e.jsx("div",{className:"ticket",children:e.jsx("div",{className:"ticket-flip-container",children:e.jsxs("div",{className:"float",children:[e.jsx("div",{className:"front",children:e.jsxs("div",{className:"ticket-body",ref:o,children:[e.jsx("div",{className:"reflex"}),e.jsx("img",{src:F,className:"icon-cube max-w-[25rem]",alt:"로고",crossOrigin:"anonymous"}),e.jsxs("header",{children:[e.jsxs("div",{className:"ticket-name flex gap-[0.2rem]",children:[e.jsxs("div",{children:[e.jsx("span",{className:"bold",style:a(1),children:"E"}),e.jsx("span",{className:"bold",style:a(2),children:"Y"}),e.jsx("span",{className:"bold",style:a(3),children:"E"}),e.jsx("span",{className:"bold",style:a(4),children:"D"}),e.jsx("span",{className:"bold",style:a(5),children:"I"}),e.jsx("span",{className:"bold",style:a(6),children:"A"})]}),e.jsxs("div",{className:"flex gap-[0.2rem]",children:[e.jsx("span",{className:"bold",style:a(8),children:"T"}),e.jsx("span",{className:"bold",style:a(9),children:"i"}),e.jsx("span",{className:"bold",style:a(10),children:"c"}),e.jsx("span",{className:"bold",style:a(11),children:"k"}),e.jsx("span",{className:"bold",style:a(11),children:"e"}),e.jsx("span",{className:"bold",style:a(11),children:"t"})]})]}),e.jsx("div",{className:"barcode"})]}),e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"event",children:[e.jsx("div",{children:e.jsx("span",{className:"bold !tracking-[0em]",children:"Eyedia"})}),e.jsx("div",{className:"!tracking-[0em]",children:"eye-tracked docent"})]}),e.jsx("div",{className:"number",children:"MuMul"}),e.jsx("div",{className:"qrcode",children:e.jsx("img",{alt:"이미지",src:y,crossOrigin:"anonymous"})})]})]})}),e.jsx("div",{className:"back",children:e.jsxs("div",{className:"ticket-body",children:[e.jsx("div",{className:"reflex"}),e.jsxs("header",{children:[e.jsxs("div",{className:"ticket-name",children:[e.jsxs("div",{children:[e.jsx("span",{style:a(1),children:"E"}),e.jsx("span",{style:a(2),children:"Y"}),e.jsx("span",{style:a(3),children:"E"}),e.jsx("span",{style:a(4),children:"D"}),e.jsx("span",{style:a(5),children:"I"}),e.jsx("span",{style:a(6),children:"A"})]}),e.jsxs("b",{children:[e.jsx("span",{className:"bold",style:a(8),children:"P"}),e.jsx("span",{className:"bold",style:a(9),children:"A"}),e.jsx("span",{className:"bold",style:a(10),children:"S"}),e.jsx("span",{className:"bold",style:a(11),children:"S"})]})]}),e.jsx("time",{dateTime:O,children:S})]}),e.jsx("div",{className:"contents",children:e.jsx("div",{className:"qrcode",children:e.jsx("img",{alt:"이미지",src:y,crossOrigin:"anonymous"})})})]})})]})})})})})}),e.jsx("div",{className:"noise capture-ignore",children:e.jsxs("svg",{height:"100%",width:"100%",children:[e.jsx("defs",{children:e.jsxs("pattern",{height:"500",width:"500",patternUnits:"userSpaceOnUse",id:"noise-pattern",children:[e.jsxs("filter",{y:"0",x:"0",id:"noise",children:[e.jsx("feTurbulence",{stitchTiles:"stitch",numOctaves:"3",baseFrequency:"0.65",type:"fractalNoise"}),e.jsx("feBlend",{mode:"screen"})]}),e.jsx("rect",{filter:"url(#noise)",height:"500",width:"500"})]})}),e.jsx("rect",{fill:"url(#noise-pattern)",height:"100%",width:"100%"})]})})]})}function M(){return e.jsx("div",{className:"max-h-dvh overflow-hidden",children:e.jsx(P,{})})}export{M as default};
